"use strict";(self.webpackChunkChemicalDetection=self.webpackChunkChemicalDetection||[]).push([[262],{57262:function(e,t,s){s.r(t),s.d(t,{default:function(){return j}});var i=s(2670),a=s(55743),d=s.n(a),n=s(26839),r=s(51223),l=s(77625);let o={Desc:"部门",Table:"BaseRFAdmin",TableType:"Role",Url:{Save:"/api/BaseRFAdmin/Save_sys_dept",GetCount:"/api/BaseRFAdmin/GetCount_sys_dept",GetList:"/api/BaseRFAdmin/GetList_sys_dept",Get:"/api/BaseRFAdmin/Get_sys_dept",Delete:"/api/BaseRFAdmin/Delete_sys_dept"},ListCols:[{title:"部门名称",dataIndex:"name",show:!0},{title:"行政区划",dataIndex:"divisionid",show:!0,scopedSlots:{customRender:"divisionid"}},{title:"排序",dataIndex:"sort_order",show:!0},{title:"创建时间",dataIndex:"create_time",show:!0},{title:"更新时间",dataIndex:"update_time",show:!1},{title:"操作",dataIndex:"op",show:!0,scopedSlots:{customRender:"op"},fixed:"right",width:300,className:"text-tc"}],ListFilter:e=>{let t=function(e){e.map((e=>{e.create_time=d()(e.create_time).isValid()?d()(e.create_time).format("YYYY-MM-DD HH:mm:ss"):null,e.update_time=d()(e.update_time).isValid()?d()(e.update_time).format("YYYY-MM-DD HH:mm:ss"):null,e.children&&e.children.length>=1&&t(e.children)}))},s=[...e];return t(s),s},DetailFilter:async e=>{let t=await(0,n.pr)();return e.create_time=d()(e.create_time).isValid()?d()(e.create_time).format("YYYY-MM-DD HH:mm:ss"):null,e.update_time=d()(e.update_time).isValid()?d()(e.update_time).format("YYYY-MM-DD HH:mm:ss"):null,e.parent_id=(0,r.cf)(t,"id",e.parent_id,"name"),e},EditRules:{name:[{required:!0,message:"请输入部门名称",trigger:"blur"}],sort_order:[{required:!0,message:"请输入排序规则",trigger:"blur"}]},EditFilter:e=>Object.assign({id:0},e),SaveFilter:e=>(e.update_by=l.Z.state.user.userDisplayName,e.update_time=d()(new Date).toJSON(),e)};var m=o,c={inject:["pGrand"]},h=s(1001),u=(0,h.Z)(c,(function(){var e=this,t=e._self._c;return t("a-form",{staticClass:"inline-form",staticStyle:{"margin-bottom":"10px",display:"flex","justify-content":"end"},attrs:{layout:"inline"}},[t("a-space",[t("a-button",{staticClass:"cant-btn-default",attrs:{type:"primary"},on:{click:function(t){return e.$emit("emAdd",null)}}},[e._v("添加")]),t("a-button",{staticClass:"cant-btn-default",attrs:{type:"danger"},on:{click:function(t){return e.pGrand.fnTb_Del(e.pGrand.dTb.rows_chks)}}},[t("span",[e._v("删除")]),e._v(" "+e._s(e.pGrand.dTb.rows_chks.length||"")+" ")])],1)],1)}),[],!1,null,null,null).exports,p={extends:i.AS,inject:["pGrand"],data(){return{schema:m}}},b=(0,h.Z)(p,(function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{visible:e.dObj.show,title:(e.dObj.mod&&e.dObj.mod.id>0?"编辑":"新增")+e.dObj.title,width:860,maskClosable:!1},on:{ok:function(t){return e.Save()},cancel:function(t){return e.Cancel()}}},[t("a-spin",{attrs:{spinning:e.dObj.load,tip:e.dObj.title+"可编辑数据加载中..."}},[t("div",{style:e.dObj.load?"min-height:280px":""},[null!=e.dObj.mod?t("a-form-model",{ref:"editref",staticClass:"inline-form",attrs:{model:e.dObj.mod,rules:e.dObj.rules,labelCol:{style:{width:"120px"}},layout:"horizontal",labelAlign:"left"}},[t("input",{attrs:{type:"hidden"},domProps:{value:e.dObj.mod.fid}}),t("a-row",[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"行政区划",prop:"divisionid"}},[t("a-tree-select",{attrs:{treeData:e.$AREA,replaceFields:{title:"name",value:"id",children:"children",key:"id"},placeholder:"请选择行政区划","allow-clear":""},model:{value:e.dObj.mod.divisionid,callback:function(t){e.$set(e.dObj.mod,"divisionid",t)},expression:"dObj.mod.divisionid"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"上级部门",prop:"parent_id"}},[t("a-tree-select",{attrs:{treeData:e.pGrand.dSysDept,replaceFields:{title:"name",value:"id",children:"children",key:"id"},placeholder:"请选择上级部门","allow-clear":""},model:{value:e.dObj.mod.parent_id,callback:function(t){e.$set(e.dObj.mod,"parent_id",t)},expression:"dObj.mod.parent_id"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"部门名称",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入部门名称",allowClear:""},model:{value:e.dObj.mod.name,callback:function(t){e.$set(e.dObj.mod,"name",t)},expression:"dObj.mod.name"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"排序",prop:"sort_order"}},[t("a-input-number",{attrs:{placeholder:"请输入排序",allowClear:""},model:{value:e.dObj.mod.sort_order,callback:function(t){e.$set(e.dObj.mod,"sort_order",t)},expression:"dObj.mod.sort_order"}})],1)],1)],1)],1):t("a-empty",{directives:[{name:"show",rawName:"v-show",value:!e.dObj.load,expression:"!dObj.load"}]})],1)])],1)}),[],!1,null,null,null).exports,f={extends:i.v6,inject:["pGrand"],data(){return{schema:m}}},_=(0,h.Z)(f,(function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{visible:e.dObj.show,title:e.dObj.title+"详情",maskClosable:!1,width:860},on:{cancel:function(t){e.dObj.show=!1},ok:function(t){e.dObj.show=!1}}},[t("a-spin",{attrs:{spinning:e.dObj.load,tip:e.dObj.title+"详情数据加载中..."}},[t("div",{style:e.dObj.load?"min-height:280px":""},[e.dObj.mod?[t("a-descriptions",{attrs:{column:2,contentStyle:{opacity:.75},bordered:""}},[t("a-descriptions-item",{attrs:{label:"部门名称",span:1}},[e._v(e._s(e.dObj.mod.name))]),t("a-descriptions-item",{attrs:{label:"行政区划",span:1}},[e._v(e._s(e._f("AREA")(e.dObj.mod.divisionid)))]),t("a-descriptions-item",{attrs:{label:"上级部门",span:1}},[e._v(e._s(e.dObj.mod.parent_id))]),t("a-descriptions-item",{attrs:{label:"排序规则",span:1}},[e._v(e._s(e.dObj.mod.sort_order))]),t("a-descriptions-item",{attrs:{label:"创建人",span:1}},[e._v(e._s(e.dObj.mod.create_by))]),t("a-descriptions-item",{attrs:{label:"创建时间",span:1}},[e._v(e._s(e.dObj.mod.create_time))]),t("a-descriptions-item",{attrs:{label:"更新人",span:1}},[e._v(e._s(e.dObj.mod.update_by))]),t("a-descriptions-item",{attrs:{label:"更新时间",span:1}},[e._v(e._s(e.dObj.mod.update_time))])],1)]:t("a-empty",{directives:[{name:"show",rawName:"v-show",value:!e.dObj.load,expression:"!dObj.load"}]})],2)])],1)}),[],!1,null,null,null).exports,O={extends:i.en,data(){return{schema:m,dSysDept:[]}},components:{IndexQuery:u,IndexEdit:b,IndexDetail:_},provide:function(){return{pGrand:this}},mounted(){},methods:{async fnTb_Query(e,t,s){this.dTb.load=!0;let i=await(0,n.pr)(!0);this.dSysDept=i,this.dTb.rows=i.length>0?this.schema.ListFilter&&this.schema.ListFilter(i[0].children)||i[0].children:[],this.dTb.load=!1}}},j=(0,h.Z)(O,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("IndexQuery",{attrs:{loading:e.dTb.load},on:{emQuery:t=>{e.dQparm=t,e.fnTb_Query()},emAdd:function(t){return e.$refs.refIndexEdit.Init(0)}}}),t("a-table",{attrs:{columns:e.dTb.colunms.filter((e=>e.show)),rowKey:e=>e.id,dataSource:e.dTb.rows,pagination:!1,loading:e.dTb.load,"row-selection":{selectedRowKeys:e.dTb.rows_chks,onChange:t=>e.dTb.rows_chks=[...t]}},on:{change:e.fnTb_Query},scopedSlots:e._u([{key:"ix",fn:function(s,i,a){return t("span",{},[e._v(e._s((e.dTb.pagination.current-1)*e.dTb.pagination.pageSize+a+1)+" ")])}},{key:"IndexType",fn:function(s,i,a){return t("span",{},[e._v(e._s(s.name))])}},{key:"op",fn:function(s,i,a){return[t("a-button",{attrs:{type:"link",size:"small",icon:"eye"},on:{click:function(t){return e.$refs.refIndexDetail.Init(i.id,"id")}}},[e._v("查看")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{attrs:{type:"link",size:"small",icon:"edit"},on:{click:function(t){return e.$refs.refIndexEdit.Init(i.id,"id")}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{attrs:{type:"link",size:"small",icon:"delete"},on:{click:function(t){return e.fnTb_Del([i.id])}}},[e._v("删除")])]}},{key:"divisionid",fn:function(t,s,i){return[e._v(e._s(e._f("AREA")(t)))]}}])}),t("IndexEdit",{ref:"refIndexEdit",on:{emOk:function(t){return e.fnTb_Query()}}}),t("IndexDetail",{ref:"refIndexDetail"})],1)}),[],!1,null,null,null).exports},2670:function(e,t,s){s.d(t,{AS:function(){return r},en:function(){return d},v6:function(){return n}});var i=s(55743),a=s.n(i);const d={data(){return{dQparm:{},dTb:{rows:[],colunms:[],rows_chks:[],load:!1,pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`共${e}条数据 当前从${t[0]}~${t[1]}条`},size:"defalut"}}},mounted(){this.dTb.colunms=this.schema.ListCols,this.fnTb_Query()},methods:{async fnTb_Query(e,t,s){this.dTb.pagination.current=e&&e.current||1,this.dTb.pagination.pageSize=e&&e.pageSize||10,this.dQparm.pageIndex=this.dTb.pagination.current,this.dQparm.pageSize=this.dTb.pagination.pageSize,this.dTb.load=!0;let i=await this.$api2(this.schema.Url.GetCount,this.dQparm);if(i.isOk){let e=parseInt(i.data);if(e>0){this.dTb.pagination.total=e;let t=await this.$api2(this.schema.Url.GetList,this.dQparm);t.isOk?this.dTb.rows=this.schema.ListFilter&&await this.schema.ListFilter(t.data)||t.data:this.$message.error(t&&t.message||this.schema.Desc+"数据列表查询失败")}else this.dTb.rows=[]}else this.$message.error(i&&i.message||this.schema.Desc+"数据分页统计失败");this.dTb.load=!1},async fnTb_Del(e){if(!e||e.length<=0)return this.$message.error("请选择要删除的"+this.schema.Desc+"数据");let t=this;this.$confirm({title:"操作确认",content:"确认删除当前选中的"+e.length+"条记录",onOk(){t.$api2(t.schema.Url.Delete,e).then((e=>{e&&e.isOk?(t.$message.success(t.schema.Desc+"数据已成功删除"),t.fnTb_Query()):t.$message.error(e&&e.message||"数据删除失败")}))}})}},filters:{time(e,t="YYYY-MM-DD HH:mm:ss"){let s=a()(e);return s.isValid()?s.format(t):null}}},n={data(){return{dObj:{show:!1,load:!1,mod:null,title:""}}},mounted(){this.dObj.title=this.schema&&this.schema.Desc||""},methods:{async Init(e,t="fid"){if(!(e&&e>0))return;this.dObj.mod=null,this.dObj.show=!0,this.dObj.load=!0;let s="fid"==t?{fid:e}:{id:e},i=await this.$api2(this.schema.Url.Get,null,s);this.dObj.load=!1,i&&i.isOk&&null!=i.data?this.dObj.mod=this.schema.DetailFilter&&await this.schema.DetailFilter(i.data)||i.data:this.$message.error(i&&i.message||this.schema.Desc+"可预览信息查询失败")}}},r={data(){return{dObj:{show:!1,load:!1,mod:null,title:"",rules:null}}},mounted(){this.dObj.title=this.schema.Desc||"",this.dObj.rules=this.schema.EditRules||null},methods:{async Init(e,t="fid"){if(parseInt(e)>=0){if(this.dObj.mod=null,this.dObj.show=!0,0==e)this.dObj.mod=this.schema.EditFilter&&await this.schema.EditFilter(null);else{this.dObj.load=!0;let s="fid"==t?{fid:e}:{id:e},i=await this.$api2(this.schema.Url.Get,null,s);i&&i.isOk&&null!=i.data?this.dObj.mod=this.schema.EditFilter&&await this.schema.EditFilter(i.data)||i.data:this.$message.error(i&&i.message||this.schema.Desc+"可编辑信息查询失败"),this.dObj.load=!1}this.$refs.editref&&this.$refs.editref.resetFields&&this.$refs.editref.resetFields()}},async Save(){this.$refs.editref.validate((async e=>{if(!e)return this.$message.error("输入数据校验失败，请重新输入"),!1;{this.dObj.load=!0;let e=this.schema.SaveFilter&&this.schema.SaveFilter(this.dObj.mod)||this.dObj.mod,t=await this.$api2(this.schema.Url.Save,e);this.dObj.load=!1,t&&t.isOk?parseInt(t.data)>0?(this.$message.success(this.schema.Desc+"数据保存成功"),this.schema.SaveFilterEnd&&(this.dObj.mod.fid=t.data,this.schema.SaveFilterEnd(this.dObj.mod)),this.dObj.show=!1,this.$emit("emOk",!0)):this.$message.error("数据保存失败"):this.$message.error(t&&t.message||this.schema.Desc+"数据保存失败")}}))},async Cancel(){this.dObj.show=!1,this.dObj.mod=null}}}}}]);