"use strict";(self.webpackChunkChemicalDetection=self.webpackChunkChemicalDetection||[]).push([[111],{84111:function(e,t,i){i.r(t),i.d(t,{default:function(){return m}});i(57658);var s=i(81639),o=i.n(s),a=i(2331),d=i(94115),r=(i(48082),i(44161)),n={data(){return{dFormMode:{name:o().get("Account_Name")||"",pwd:(0,a.oN)(o().get("Account_Pwd")||"")},dFormRules:{name:[{required:!0,message:"请输入登录用户名",trigger:"change"}],pwd:[{required:!0,message:"请输入登录密码",trigger:"change"}]},dFormOp:{load:!1,disabled:!1,remeber:!0},dShowLogbox:!1}},computed:{dConfig:function(){return"undefined"!=typeof globalLoginConfig?globalLoginConfig:{mod:0,url1_login:"",url1_userinfo:""}},dLicense:function(){return"undefined"!=typeof globalLicense?globalLicense:null}},mounted(){(null==this.dLicense||this.dLicense.length<=1)&&(this.$message.error("软件未授权，请联系软件供应商。",0),this.dFormOp.disabled=!0),this.$route.query&&this.$route.query.token?(this.dShowLogbox=!1,this.fnSubmitToken()):this.dShowLogbox=!0},methods:{fnVali(e){this.dFormOp.disabled=!(this.dFormMode.name&&this.dFormMode.name.length>0&&this.dFormMode.pwd&&this.dFormMode.pwd.length>0)},async fnSubmit(){this.$refs.dFormDom.validate((async e=>{if(!e)return;let t=await this.$api2("/api/Permission/IsLegal",null,{license:this.dLicense},"POST",!1);if(!(t&&t.isOk&&Boolean(t.data)))return this.$message.error("软件未授权，请联系软件供应商。",0),void(this.dFormOp.disabled=!0);let i=!1;0==this.dConfig.mod&&(i=await this.fnSubmitG2()),1==this.dConfig.mod&&(i=await this.fnSubmitThird()),2==this.dConfig.mod&&(i=await this.fnSubmitMod()),i&&(this.dFormOp.remeber&&(o().set("Account_Name",this.dFormMode.name),o().set("Account_Pwd",(0,a.Qo)(this.dFormMode.pwd))),this.$message.loading("登录成功,正在加载资源...",1,(()=>{this.dShowLogbox=!1,window.location.href="/board/index1"})))}))},fnEncrypt(e){return new d.Z(128,1e3).encrypt("c49b777888ee6ff1fae48e1ea1ecf797","57ec537722a8a351b8c4f7d239ac9d52","1234123412ABCDEF#key",e)},async fnSubmitG2(){this.dFormOp.load=!0,this.dFormOp.disabled=!0;const e=this.$message.loading("正在登录中...",0);let t={userName:this.fnEncrypt(this.dFormMode.name),pcode:this.fnEncrypt(this.dFormMode.pwd)},i=await this.$api2("/api/BaseRFAdmin/Login",null,t,"POST",!1);if(this.dFormOp.load=!1,this.dFormOp.disabled=!1,e(),i){if(i.isOk&&i.data){let e={userDisplayName:i.data.name,userID:i.data.id,token:i.data.token,avatar:i.data.avatar,IsLogin:!0,dept_id:i.data.dept_id,division_id:0,division_deep:i.data.division&&i.data.division.division_deep,roles:[i.data.isadmin?"admin":"user"]};this.$store.commit("SET_USER",e);let t=await this.$api2("/api/BaseRFAdmin/Get_sys_dept",null,{id:i.data.dept_id});return t&&t.isOk&&t.data&&(e.division_id=t.data.divisionid),this.$store.commit("SET_USER",e),!0}this.$message.error(i.message||"登录失败！")}else this.$message.error("登录异常！");return!1},async fnSubmitThird(){this.dFormOp.load=!0,this.dFormOp.disabled=!0;const e=this.$message.loading("正在登录中...",0);let t={username:this.dFormMode.name,password:this.dFormMode.pwd},i=await(0,r.Z)({timeout:6e3,method:"POST",url:this.dConfig.url1_login,headers:{isToken:!1,"Content-Type":"application/json"},data:t}).catch((e=>{}));if(i&&200==i.status&&i.data&&200==i.data.code){let t=i.data.data.access_token,s=await(0,r.Z)({timeout:1e3,method:"GET",url:this.dConfig.url1_userinfo,headers:{"Content-Type":"application/json",Authorization:t},data:{}}).catch((e=>{}));if(s&&200==s.status&&s.data&&s.data&&200==s.data.code){let i=s.data.user;return this.$store.commit("SET_USER",{userDisplayName:i.nickName,userID:i.userId,token:t,IsLogin:!0,roles:"admin"}),this.dFormOp.load=!1,this.dFormOp.disabled=!1,e(),!0}this.$message.error("获取登录用户信息失败！")}else this.$message.error("授权登录失败！");return this.dFormOp.load=!1,this.dFormOp.disabled=!1,e(),!1},async fnSubmitMod(){this.dFormOp.load=!0,this.dFormOp.disabled=!0;const e=this.$message.loading("正在登录中...",0);return await new Promise((e=>setTimeout((()=>e()),1e3))),this.$store.commit("SET_USER",{userDisplayName:this.dFormMode.name,userID:10086,token:"token10086test",IsLogin:!0,roles:"admin"}),this.dFormOp.load=!1,this.dFormOp.disabled=!1,e(),!0},async fnSubmitToken(){let e=this.$route.query;return 0==this.dConfig.mod||2==this.dConfig.mod?null==e.userDisplayName||e.userDisplayName.length<=0?void this.$message.error("用户名参数必须传递"):null==e.userID||e.userID<=0?void this.$message.error("用ID参数必须传递"):null==e.token||e.token.length<=0?void this.$message.error("用token参数必须传递"):(this.$store.commit("SET_USER",{userDisplayName:e.userDisplayName,userID:e.userID,token:e.token,IsLogin:!0,roles:"admin"}),void this.$router.push(this.$route.query.path||"/Index")):1==this.dConfig.mod?null==e.token||e.token.length<=0?void this.$message.error("用token参数必须传递"):void await(0,r.Z)({timeout:1e3,method:"GET",url:this.dConfig.url1_userinfo,headers:{"Content-Type":"application/json",Authorization:e.token},data:{}}).then((t=>{if(t&&200==t.status&&t.data){let i=t.data.user;this.$store.commit("SET_USER",{userDisplayName:i.nickName,userID:i.Id,token:e.token,IsLogin:!0}),this.$router.push(this.$route.query.path||"/Index")}else this.$message.error("获取登录信息失败！")})).catch((e=>{this.$message.error("获取登录信息异常！")})):void 0}}},m=(0,i(1001).Z)(n,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("div",{staticClass:"head"}),t("div",{staticClass:"tboxtit"},[e._v(" "+e._s(e.$store.state.title)+" ")]),t("div",{staticClass:"box"},[t("div",{staticClass:"box-tit"},[e._v("用户登录")]),t("div",{staticClass:"box-form"},[t("a-form-model",{ref:"dFormDom",staticClass:"box-form-mod",attrs:{model:e.dFormMode,rules:e.dFormRules},on:{validate:e.fnVali}},[t("a-form-model-item",{ref:"name",staticClass:"box-form-mod-item",attrs:{"has-feedback":"",prop:"name"}},[t("a-input",{staticClass:"ipt",attrs:{placeholder:"请输入您的账号",allowClear:"",size:"large"},scopedSlots:e._u([{key:"prefix",fn:function(){return[t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:i(24598)}})]},proxy:!0}]),model:{value:e.dFormMode.name,callback:function(t){e.$set(e.dFormMode,"name","string"==typeof t?t.trim():t)},expression:"dFormMode.name"}})],1),t("a-form-model-item",{ref:"pwd",staticClass:"box-form-mod-item",attrs:{"has-feedback":"",prop:"pwd"}},[t("a-input-password",{staticClass:"ipt",attrs:{placeholder:"请输入您的密码",allowClear:"",autocomplete:"",size:"large"},scopedSlots:e._u([{key:"prefix",fn:function(){return[t("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:i(48289)}})]},proxy:!0}]),model:{value:e.dFormMode.pwd,callback:function(t){e.$set(e.dFormMode,"pwd","string"==typeof t?t.trim():t)},expression:"dFormMode.pwd"}})],1),t("div",{staticClass:"flexcb"},[t("a-tooltip",{attrs:{title:"加密存储,7日内有效！"}},[t("a-checkbox",{staticClass:"ani-border",attrs:{size:"large"},model:{value:e.dFormOp.remeber,callback:function(t){e.$set(e.dFormOp,"remeber",t)},expression:"dFormOp.remeber"}},[e._v("记住帐户密码")])],1),t("a-button",{staticClass:"ani-border",attrs:{type:"link"},on:{click:function(t){return e.$message.warning("请联系管理员帮忙处理。")}}},[e._v("忘记密码?")])],1),t("a-form-model-item",[t("a-button",{staticStyle:{width:"100%"},attrs:{type:"primary",disabled:e.dFormOp.disabled,loading:e.dFormOp.load,size:"large"},on:{click:e.fnSubmit}},[e._v("登录")])],1)],1)],1)])])}),[],!1,null,"f04b9f52",null).exports},94115:function(e,t,i){const s=i(48082);var o=function(e,t){this.keySize=e/32,this.iterationCount=t};o.prototype.generateKey=function(e,t){return s.PBKDF2(t,s.enc.Hex.parse(e),{keySize:this.keySize,iterations:this.iterationCount})},o.prototype.encrypt=function(e,t,i,o){var a=this.generateKey(e,i);return s.AES.encrypt(o,a,{iv:s.enc.Hex.parse(t)}).ciphertext.toString(s.enc.Base64)},o.prototype.decrypt=function(e,t,i,o){var a=this.generateKey(e,i),d=s.lib.CipherParams.create({ciphertext:s.enc.Base64.parse(o)});return s.AES.decrypt(d,a,{iv:s.enc.Hex.parse(t)}).toString(s.enc.Utf8)},t.Z=o},2331:function(e,t,i){i.d(t,{Qo:function(){return d},Vj:function(){return n},oN:function(){return r}});i(23767),i(8585),i(68696);const s=i(48082),o=s.enc.Utf8.parse("1234123412ABCDEF"),a=s.enc.Utf8.parse("ABCDEF1234123412"),d=e=>{let t=s.enc.Utf8.parse(e);return s.AES.encrypt(t,o,{iv:a,mode:s.mode.CBC,padding:s.pad.Pkcs7}).ciphertext.toString().toUpperCase()},r=e=>{let t=s.enc.Hex.parse(e),i=s.enc.Base64.stringify(t);return s.AES.decrypt(i,o,{iv:a,mode:s.mode.CBC,padding:s.pad.Pkcs7}).toString(s.enc.Utf8).toString()},n=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))},48289:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAbCAYAAACJISRoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAZJJREFUeNrs1s8rhEEYwPFdVmtFOLjIr6yDg4MfJ0kuDiKuFCU57M1FUa4uDnLSFn+ARZSDXBRKOcnNwYFEKeLgxL42r+/Us/Ua3vfd2XYlmfrUzNvs+8w788zMBm3bDuS7FAR+oPydICH9QfVlUn9UigEMoRNluMAREjjXf3AXDX9qB/WF14LUYRmDLoN8xixWvIKEPL6yAguOAAfYxhPaMabGhEXcYyfj6XKUbvRLXX3NDF6kvYEtrKMRMZzgwWThg2hAuYwy4QiQLqfYlHqNfLlRdqmFepO6hZRLH0vqry59fKcr6XjZu0ufuGSacmUSpAhNaJF2BG0SLKL1VVN4hhJZwxth+wWJS+YUS7sKqxnuu1tMYt9vTUYcAUxLLSZM1kQvKhGO8YgORD0yM6uzS83xFPowjF4cuvRNZRtkTzZfOq2vsZTrU1httLD2rDLXQbow50jhHszn4z4ZRavso2nUZ32feBR1jo3Lvmk2eWfIcB/EhNHsfBdkV25Cy3AAhXLerX3ZOP9/iX5dkA8BBgAe/1MCxJCyoQAAAABJRU5ErkJggg=="},24598:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAbCAYAAACJISRoAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGwGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgMTE2LmRkYzdiYzQsIDIwMjEvMDgvMTctMTM6MTg6MzcgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIgeG1wOkNyZWF0ZURhdGU9IjIwMjItMTAtMzFUMDE6MDg6MzMrMDg6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMjItMTEtMDFUMTY6Mjg6MDUrMDg6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDIyLTExLTAxVDE2OjI4OjA1KzA4OjAwIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjBjYmFkMDJjLTM2N2YtYjc0Yy04M2Q2LTdkYWQ3NmIyYThjNCIgeG1wTU06RG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOmM5ZDZmOTZjLTA3YmQtZjQ0OS1iODM5LTVkNTNiMjJmMTUyZSIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjQzMzlmZDQ3LTdkZmUtOGE0ZC05ZjQyLWNjMDhkOTM2Njg3YSIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9InNSR0IgSUVDNjE5NjYtMi4xIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6NDMzOWZkNDctN2RmZS04YTRkLTlmNDItY2MwOGQ5MzY2ODdhIiBzdEV2dDp3aGVuPSIyMDIyLTEwLTMxVDAxOjA4OjMzKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjJhMGIyODQ0LTViMjEtNzM0Mi1iZjEwLTAyN2U4ZjZmMjBmYyIgc3RFdnQ6d2hlbj0iMjAyMi0xMC0zMVQwMTowODozMyswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIxLjIgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDowY2JhZDAyYy0zNjdmLWI3NGMtODNkNi03ZGFkNzZiMmE4YzQiIHN0RXZ0OndoZW49IjIwMjItMTEtMDFUMTY6Mjg6MDUrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCAyMS4yIChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7mdAgxAAABRElEQVRIx+3WvUoDQRRA4Q0GIiIKUZH4BrEQbLQRLEREUYKWNlaCprTxFexstEhAtBIVCwX7VIKFoA+QgD8QkIAEBEnleC7cSAi6u3eXgEWKj02KmZPdmVniOee8TvO6kciRTLnxmwRGsIQ9nOMMp0o+XyKPvuY4S6QH07iCC3CBtDWS0MBjiIA4xIA1MqqPxoVUsEbkLhZQ72QkiW1DQBxh0BKRBd8yRk6sETGHd0NkFylrZBjHIQNlZFvHW87JJO4DAjWst4+1nvgZXOOtbfIP3GFD1zBWxNOtOYtN7OgrJIexv8ZYI+O6CRZ14lW9rmAeU+iNEpHDuIYibvGMKl7xhBf9Lh70RSnnaihsRPb6vk78ZdjCdV27iaBIPw7QMB7EJvlRJdltfpFlfEYMtIYqfpGbmIEffpGS3kls3X8r/zvyDQtGNTLu7826AAAAAElFTkSuQmCC"}}]);