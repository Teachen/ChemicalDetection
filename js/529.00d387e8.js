"use strict";(self.webpackChunkChemicalDetection=self.webpackChunkChemicalDetection||[]).push([[529],{83047:function(e,t,a){a.d(t,{Z:function(){return n}});a(57658);var i=a(2331),l={props:{objs:Array||[],title:{type:String,default:"自定义属性"},maxTagCount:Number||3,disabled:Boolean||!1},data(){return{visible:!1,columns:[],chks:[],list:[]}},mounted(){this.columns=[{title:"项目",dataIndex:"fieldName",scopedSlots:{customRender:"fieldName"}},{title:"内容",dataIndex:"fieldValue",scopedSlots:{customRender:"fieldValue"}},{title:"操作",dataIndex:"op",width:"30%",scopedSlots:{customRender:"op"},aligin:"center"}]},methods:{rowAdd(){this.list.push({fileId:(0,i.Vj)(),fieldName:"",fieldValue:"",fieldName2:"",fieldValue2:"",edit:!0})},rowDel(e){this.list=this.list.filter((t=>-1==e.indexOf(t.fileId))),this.chks=this.chks.filter((e=>this.list.find((t=>t.fileId==e))))},rowEdit(e){e.fieldName2=e.fieldName,e.fieldValue2=e.fieldValue,e.edit=!0},rowChange(e,t,a){t[a]=e},rowSave(e){e.fieldName=e.fieldName2,e.fieldValue=e.fieldValue2,e.edit=!1},rowCancel(e){e.fieldName2=e.fieldName,e.fieldValue2=e.fieldValue,e.edit=!1},commit(){this.list.find((e=>e.edit))?this.$message.warning("还有正在编辑的行"):(this.$emit("update:objs",this.list.map((e=>({fieldName:e.fieldName,fieldValue:e.fieldValue})))),this.visible=!1)},fnInit(){this.disabled||(this.visible=!0,this.objs&&this.objs.length>0&&(this.list=this.objs.map((e=>({fileId:(0,i.Vj)(),fieldName:e.fieldName,fieldValue:e.fieldValue,fieldName2:e.fieldName,fieldValue2:e.fieldValue,edit:!1})))))},deselect(e){let t=this.list.find((t=>t=>t.fieldName+":"+t.fieldValue==e));t&&(this.rowDel([t.fileId]),this.commit())}}},n=(0,a(1001).Z)(l,(function(){var e=this,t=e._self._c;return t("div",[t("a-input-group",{attrs:{compact:""},on:{click:e.fnInit}},[t("a-select",{style:"width:calc(100% - 32px )",attrs:{value:(e.objs||[]).map((e=>e.fieldName+":"+e.fieldValue)),mode:"multiple",placeholder:e.title,maxTagCount:e.maxTagCount,options:[],open:!1,disabled:e.disabled},on:{deselect:e.deselect}}),t("a-button",{staticStyle:{width:"32px"},attrs:{type:"primary",ghost:"",disabled:e.disabled,icon:"edit"}})],1),t("a-modal",{attrs:{visible:e.visible,title:e.title,width:"860px",bodyStyle:{padding:"10px"}},on:{cancel:function(t){e.visible=!1},ok:e.commit}},[t("a-form",{staticClass:"inline-form",staticStyle:{"margin-bottom":"5px",display:"flex","justify-content":"end"},attrs:{layout:"inline"}},[t("a-form-item",[t("a-space",[t("a-button",{staticClass:"editable-add-btn",on:{click:function(t){return e.rowAdd()}}},[e._v("添加")]),t("a-button",{staticClass:"editable-add-btn",attrs:{disabled:e.chks.length<=0},on:{click:function(t){return e.rowDel(e.chks)}}},[e._v("删除 "+e._s(e.chks.length||""))])],1)],1)],1),t("a-table",{attrs:{columns:e.columns,"data-source":e.list,bordered:"",rowKey:"fileId","row-selection":{selectedRowKeys:e.chks,onChange:t=>e.chks=[...t]},size:"small"},scopedSlots:e._u([{key:"fieldName",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.fieldName2},on:{change:t=>e.rowChange(t.target.value,i,"fieldName2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"fieldValue",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.fieldValue2},on:{change:t=>e.rowChange(t.target.value,i,"fieldValue2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"op",fn:function(a,i,l){return[i.edit?[t("a-button",{staticStyle:{color:"#87d068"},attrs:{type:"link",size:"small",icon:"check-circle"},on:{click:function(t){return e.rowSave(i)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{staticStyle:{color:"orange"},attrs:{type:"link",size:"small",icon:"issues-close"},on:{click:function(t){return e.rowCancel(i)}}},[e._v("取消")])]:[t("a-button",{staticStyle:{color:"#06E464"},attrs:{type:"link",size:"small",icon:"edit"},on:{click:function(t){return e.rowEdit(i)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:function(t){return e.rowDel([i.fileId])}}},[t("a-button",{staticStyle:{color:"#F70000"},attrs:{type:"link",size:"small",icon:"save"}},[e._v("删除")])],1)]]}}])})],1)],1)}),[],!1,null,null,null).exports},41017:function(e,t,a){a.d(t,{Z:function(){return n}});a(57658);var i=a(2331),l={props:{objs:Array||[],title:{type:String,default:"自定义属性"},maxTagCount:Number||3,disabled:Boolean||!1},data(){return{visible:!1,columns:[],chks:[],list:[]}},mounted(){this.columns=[{title:"姓名",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"电话",dataIndex:"phone",scopedSlots:{customRender:"phone"}},{title:"车牌号",dataIndex:"plateNumber",scopedSlots:{customRender:"plateNumber"}},{title:"QQ",dataIndex:"qq",scopedSlots:{customRender:"qq"}},{title:"微信",dataIndex:"wechat",scopedSlots:{customRender:"wechat"}},{title:"操作",dataIndex:"op",width:200,scopedSlots:{customRender:"op"},aligin:"center"}]},methods:{rowAdd(){this.list.push({fileId:(0,i.Vj)(),edit:!0,name:"",phone:"",plateNumber:"",qq:"",wechat:"",name2:"",phone2:"",plateNumber2:"",qq2:"",wechat2:""})},rowDel(e){this.list=this.list.filter((t=>-1==e.indexOf(t.fileId))),this.chks=this.chks.filter((e=>this.list.find((t=>t.fileId==e))))},rowEdit(e){e.name2=e.name,e.phone2=e.phone,e.plateNumber2=e.plateNumber,e.qq2=e.qq,e.wechat2=e.wechat,e.edit=!0},rowChange(e,t,a){t[a]=e},rowSave(e){e.name=e.name2,e.phone=e.phone2,e.plateNumber=e.plateNumber2,e.qq=e.qq2,e.wechat=e.wechat2,e.edit=!1},rowCancel(e){e.name2=e.name,e.phone2=e.phone,e.plateNumber2=e.plateNumber,e.qq2=e.qq,e.wechat2=e.wechat,e.edit=!1},commit(){this.list.find((e=>e.edit))?this.$message.warning("还有正在编辑的行"):(this.$emit("update:objs",this.list.map((e=>({name:e.name,phone:e.phone,plateNumber:e.plateNumber,qq:e.qq,wechat:e.wechat})))),this.visible=!1)},fnInit(){this.disabled||(this.visible=!0,this.objs&&this.objs.length>0&&(this.list=this.objs.map((e=>({fileId:(0,i.Vj)(),edit:!1,name:e.name,phone:e.phone,plateNumber:e.plateNumber,qq:e.qq,wechat:e.wechat,name2:e.name,phone2:e.phone,plateNumber2:e.plateNumber,qq2:e.qq,wechat2:e.wechat})))))},deselect(e){let t=this.list.find((t=>t=>e==this.showlbl(t)));t&&(this.rowDel([t.fileId]),this.commit())},showlbl(e){let t=[];return null!=e.phone&&e.phone.length>0&&t.push("电话:"+e.phone),null!=e.plateNumber&&e.plateNumber.length>0&&t.push("车牌:"+e.plateNumber),null!=e.qq&&e.qq.length>0&&t.push("QQ:"+e.qq),null!=e.wechat&&e.wechat.length>0&&t.push("微信:"+e.wechat),e.name+"("+t.join("/")+")"}}},n=(0,a(1001).Z)(l,(function(){var e=this,t=e._self._c;return t("div",[t("a-input-group",{attrs:{compact:""},on:{click:e.fnInit}},[t("a-select",{style:"width:calc(100% - 32px )",attrs:{value:(e.objs||[]).map((t=>e.showlbl(t))),mode:"multiple",placeholder:e.title,maxTagCount:e.maxTagCount,options:[],open:!1,disabled:e.disabled},on:{deselect:e.deselect}}),t("a-button",{staticStyle:{width:"32px"},attrs:{type:"primary",ghost:"",disabled:e.disabled,icon:"edit"}})],1),t("a-modal",{attrs:{visible:e.visible,title:e.title,width:"1020px",bodyStyle:{padding:"10px"}},on:{cancel:function(t){e.visible=!1},ok:e.commit}},[t("a-form",{staticClass:"inline-form",staticStyle:{"margin-bottom":"5px",display:"flex","justify-content":"end"},attrs:{layout:"inline"}},[t("a-form-item",[t("a-space",[t("a-button",{staticClass:"editable-add-btn",on:{click:function(t){return e.rowAdd()}}},[e._v("添加")]),t("a-button",{staticClass:"editable-add-btn",attrs:{disabled:e.chks.length<=0},on:{click:function(t){return e.rowDel(e.chks)}}},[e._v("删除 "+e._s(e.chks.length||""))])],1)],1)],1),t("a-table",{attrs:{columns:e.columns,"data-source":e.list,bordered:"",rowKey:"fileId","row-selection":{selectedRowKeys:e.chks,onChange:t=>e.chks=[...t]},size:"small"},scopedSlots:e._u([{key:"name",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.name2},on:{change:t=>e.rowChange(t.target.value,i,"name2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"phone",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.phone2},on:{change:t=>e.rowChange(t.target.value,i,"phone2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"plateNumber",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.plateNumber2},on:{change:t=>e.rowChange(t.target.value,i,"plateNumber2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"qq",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.qq2},on:{change:t=>e.rowChange(t.target.value,i,"qq2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"wechat",fn:function(a,i,l){return[i.edit?t("a-input",{staticStyle:{margin:"-5px 0"},attrs:{value:i.wechat2},on:{change:t=>e.rowChange(t.target.value,i,"wechat2")}}):[e._v(" "+e._s(a)+" ")]]}},{key:"op",fn:function(a,i,l){return[i.edit?[t("a-button",{staticStyle:{color:"#87d068"},attrs:{type:"link",size:"small",icon:"check-circle"},on:{click:function(t){return e.rowSave(i)}}},[e._v("保存")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-button",{staticStyle:{color:"orange"},attrs:{type:"link",size:"small",icon:"issues-close"},on:{click:function(t){return e.rowCancel(i)}}},[e._v("取消")])]:[t("a-button",{staticStyle:{color:"#06E464"},attrs:{type:"link",size:"small",icon:"edit"},on:{click:function(t){return e.rowEdit(i)}}},[e._v("编辑")]),t("a-divider",{attrs:{type:"vertical"}}),t("a-popconfirm",{attrs:{title:"确认删除?"},on:{confirm:function(t){return e.rowDel([i.fileId])}}},[t("a-button",{staticStyle:{color:"#F70000"},attrs:{type:"link",size:"small",icon:"save"}},[e._v("删除")])],1)]]}}])})],1)],1)}),[],!1,null,null,null).exports},11928:function(e,t,a){a.d(t,{Z:function(){return u}});var i=a(2670),l=a(28511),n=a(26839),s=a(21438),o={props:{pSrc:String||""},components:{FilePreview:s.Z},data(){return{dFileList:[],dLoad:!1,previewVisible:!1,previewImage:""}},mounted(){this.fnInit()},methods:{fnInit(){this.pSrc&&this.pSrc.length>0?this.dFileList=[{url:"/g3"+this.pSrc,uid:"-1",name:"image.png",status:"done"}]:this.dFileList=[]},async fnPreview(e){this.$refs.FilePreview.Init(e.url)},async fnChange(e){if(this.dFileList=[...e.fileList].slice(-1),this.dLoad="uploading"===e.file.status,"done"===e.file.status){let t=e.file.response;t&&t.length>0&&(this.dFileList[0].url="/g3"+t[0],this.$emit("update:pSrc",t[0],e.file.name))}"removed"===e.file.status&&this.$emit("update:pSrc","")}},watch:{pSrc(e){this.fnInit()}}},r=a(1001),d=(0,r.Z)(o,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"clearfix"},[t("a-upload",{attrs:{action:"/g2/api/File/UploadFiles","list-type":"picture-card","file-list":e.dFileList,name:"files"},on:{preview:e.fnPreview,change:e.fnChange}},[e.dFileList.length<=0?t("div",[t("a-icon",{attrs:{type:"plus",color:"#1890ff"}}),t("a-button",{staticStyle:{"margin-top":"8px"},attrs:{type:"primary",size:"small"}},[e._v("选择文件")])],1):e._e()]),t("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:function(t){e.previewVisible=!1}}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})]),t("FilePreview",{ref:"FilePreview"})],1)}),[],!1,null,null,null).exports,c={extends:i.AS,components:{Upload:d},data(){return{schema:l.Z,DICT_AttachmentList:[],TableID_Name:null,isCom:!1}},async created(){this.DICT_AttachmentList=[{label:"未选择",value:""},...(await(0,n.ig)("DICT_AttachmentList")).map((e=>({label:e.comment,value:e.name})))]},methods:{fnSetPro(e,t,a){this.TableID_Name=a,e&&e.length>0&&(this.dObj.mod.tableName=e),t&&parseInt(t)>0&&(this.dObj.mod.tableID=t),this.isCom=!0},fnFileChange(e,t){this.$refs.relativePath.onFieldChange(),null!=this.dObj.mod.name&&0!=this.dObj.mod.name.length||this.dObj.mod.relativePath.length>0&&(this.dObj.mod.name=t)}}},u=(0,r.Z)(c,(function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{visible:e.dObj.show,title:(e.TableID_Name||"")+" "+e.dObj.title+(e.dObj.mod&&e.dObj.mod.fid>0?"编辑":"新增"),width:860,maskClosable:!1},on:{ok:function(t){return e.Save()},cancel:function(t){e.dObj.show=!1}}},[t("a-spin",{attrs:{spinning:e.dObj.load,tip:e.dObj.title+"可编辑数据加载中..."}},[t("div",{style:e.dObj.load?"min-height:280px":""},[null!=e.dObj.mod?t("a-form-model",{ref:"editref",staticClass:"inline-form",attrs:{model:e.dObj.mod,rules:e.dObj.rules,labelCol:{style:{width:"120px"}},layout:"horizontal",labelAlign:"left"}},[t("input",{attrs:{type:"hidden"},domProps:{value:e.dObj.mod.fid}}),t("a-row",{attrs:{gutter:[0,0]}},[t("a-col",{attrs:{span:24}},[t("a-form-model-item",{attrs:{label:"文件名",prop:"name"}},[t("a-input",{attrs:{placeholder:"请输入文件名",allowClear:""},model:{value:e.dObj.mod.name,callback:function(t){e.$set(e.dObj.mod,"name",t)},expression:"dObj.mod.name"}})],1)],1),e.isCom?e._e():t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"文件归属",prop:"tableName"}},[t("a-select",{attrs:{placeholder:"选择文件归属",options:e.DICT_AttachmentList},model:{value:e.dObj.mod.tableName,callback:function(t){e.$set(e.dObj.mod,"tableName",t)},expression:"dObj.mod.tableName"}})],1)],1),e.isCom?e._e():t("a-col",{attrs:{span:12}},[t("a-form-model-item",{attrs:{label:"归属ID",prop:"tableID"}},[t("a-input-number",{staticStyle:{width:"100%"},attrs:{placeholder:"请输入归属ID",allowClear:"",disabled:""==e.dObj.mod.tableName},model:{value:e.dObj.mod.tableID,callback:function(t){e.$set(e.dObj.mod,"tableID",t)},expression:"dObj.mod.tableID"}})],1)],1),t("a-col",{attrs:{span:24}},[t("a-form-model-item",{ref:"relativePath",attrs:{label:"选择文件",prop:"relativePath",autoLink:!1}},[t("Upload",{attrs:{pSrc:e.dObj.mod.relativePath},on:{"update:pSrc":[function(t){return e.$set(e.dObj.mod,"relativePath",t)},(t,a)=>e.fnFileChange(t,a)],"update:p-src":function(t){return e.$set(e.dObj.mod,"relativePath",t)}}})],1)],1)],1)],1):e._e()],1)])],1)}),[],!1,null,null,null).exports},2331:function(e,t,a){a.d(t,{Qo:function(){return s},Vj:function(){return r},oN:function(){return o}});a(23767),a(8585),a(68696);const i=a(48082),l=i.enc.Utf8.parse("1234123412ABCDEF"),n=i.enc.Utf8.parse("ABCDEF1234123412"),s=e=>{let t=i.enc.Utf8.parse(e);return i.AES.encrypt(t,l,{iv:n,mode:i.mode.CBC,padding:i.pad.Pkcs7}).ciphertext.toString().toUpperCase()},o=e=>{let t=i.enc.Hex.parse(e),a=i.enc.Base64.stringify(t);return i.AES.decrypt(a,l,{iv:n,mode:i.mode.CBC,padding:i.pad.Pkcs7}).toString(i.enc.Utf8).toString()},r=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))},28511:function(e,t,a){var i=a(55743),l=a.n(i);let n={Desc:"附件数据",Table:"Attachment",TableType:"Common"};n.Url={Save:`/api/${n.TableType}/Save${n.Table}s`,GetCount:`/api/${n.TableType}/Get${n.Table}Count`,GetList:`/api/${n.TableType}/Get${n.Table}List`,Get:`/api/${n.TableType}/Get${n.Table}`,Delete:`/api/${n.TableType}/Delete${n.Table}s`},n.ListCols=[{title:"序号",dataIndex:"ix",show:!0,scopedSlots:{customRender:"ix"},width:80},{title:"编号",dataIndex:"fid",show:!1},{title:"文件名称",dataIndex:"name",show:!0,ellipsis:!0},{title:"归属ID",dataIndex:"tableID",show:!1},{title:"归属名",dataIndex:"tableName",show:!0,scopedSlots:{customRender:"tableName"},width:100},{title:"格式",dataIndex:"relativePath_suffix",show:!0,scopedSlots:{customRender:"relativePath_suffix"},width:80},{title:"更新日期",dataIndex:"uploadDate",show:!0,width:170},{title:"预览",dataIndex:"relativePath",show:!0,scopedSlots:{customRender:"relativePath"},width:180},{title:"操作",dataIndex:"op",show:!0,scopedSlots:{customRender:"op"},width:180}],n.ListFilter=e=>{let t=[...e];return t.map((e=>{e.uploadDate=l()(e.uploadDate).isValid()?l()(e.uploadDate).format("YYYY-MM-DD HH:mm:ss"):null})),t},n.DetailFilter=e=>(e.uploadDate=l()(e.uploadDate).format("YYYY-MM-DD HH:mm:ss"),e),n.EditRules={name:[{required:!0,message:"请输入文件名",trigger:"blur"}],tableName:[{required:!0,message:"请选择文件归属",trigger:"blur"}],tableID:[{required:!0,message:"请输入文件归属ID",trigger:"blur"}],relativePath:[{required:!0,trigger:"change",validator:async(e,t)=>t&&t.length>0?Promise.resolve():Promise.reject("请选择文件上传")}]},n.EditFilter=e=>Object.assign({fid:0,name:"",relativePath:"",tableID:null,tableName:"",uploadDate:null},e),n.SaveFilter=e=>(e.uploadDate=l()().toJSON(),[e]),t.Z=n}}]);