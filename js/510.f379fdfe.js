"use strict";(self.webpackChunkChemicalDetection=self.webpackChunkChemicalDetection||[]).push([[510],{88011:function(e,t,a){a.d(t,{Z:function(){return o}});var i=a(66281),s=a.n(i),l=a(11159),n=a(55743),d=a.n(n),r={data(){return{visible:!1,dQparm:{name:"",type:"",assigndeptid:null,startDate:null,endDate:null},dTb:{rows:[],colunms:[],rows_chks:[],load:!1,pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`共${e}条数据 当前从${t[0]}~${t[1]}条`}},dObj:{}}},props:{obj:Object||{},disabled:Boolean||!1},async created(){},methods:{fnInit(){if(this.disabled)return;let e=s()(this.obj);this.visible=!0,this.dObj=e,this.dTb={rows:[],colunms:[],rows_radio:null,load:!1,pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`共${e}条数据 当前从${t[0]}~${t[1]}条`}},this.dTb.colunms=[{title:"选择",dataIndex:"ck",align:"center",width:80,scopedSlots:{customRender:"ck"}},{title:"编号",dataIndex:"clueCode",align:"center",scopedSlots:{customRender:"clueCode"}},{title:"类型",dataIndex:"caseCategoryID",align:"center",scopedSlots:{customRender:"caseCategoryID"}},{title:"名称",dataIndex:"name",align:"center"},{title:"下发时间",dataIndex:"assignDate",align:"center",scopedSlots:{customRender:"assignDate"}},{title:"内容",dataIndex:"content",align:"center",scopedSlots:{customRender:"content"},ellipsis:!0}],this.dTb.rows=e&&e.fid&&e.fid.length>0?[e]:[],this.dTb.rows&&this.dTb.rows.length<=0&&this.fnQuery()},async fnQuery(e,t,a){this.dTb.pagination.current=e&&e.current||1,this.dTb.pagination.pageSize=e&&e.pageSize||10;let i={pageIndex:this.dTb.pagination.current,pageSize:this.dTb.pagination.pageSize};this.dQparm.name&&this.dQparm.name.length>0&&(i.name=this.dQparm.name.trim()),this.dQparm.startDate&&d()(this.dQparm.startDate).isValid()&&(i.startDate=this.dQparm.startDate),this.dQparm.endDate&&d()(this.dQparm.endDate).isValid()&&(i.endDate=this.dQparm.endDate),this.dQparm.assigndeptid&&this.dQparm.assigndeptid>0&&(i.assigndeptid=this.dQparm.assigndeptid),this.dTb.load=!0;let n=await this.$api2(l.Z.Url.GetCount,i);if(n&&null!=n.data&&n.data>=0)if(this.dTb.pagination.total=parseInt(n.data),n.data>0){let e=await this.$api2(l.Z.Url.GetList,i);e&&e.isOk?this.dTb.rows=s()(e.data):this.$message.error("数据查询失败")}else this.$message.error("暂无数据");else this.$message.error(n&&n.message||"数据查询失败");this.dTb.load=!1},async fnOk(){this.$emit("update:obj",this.dObj),this.visible=!1},fnChange(e){this.$emit("update:obj",{}),this.visible=!1},fnRangeChange(e){2==e.length?(this.dQparm.startDate=e[0].toJSON(),this.dQparm.endDate=e[1].toJSON()):(this.dQparm.startDate=null,this.dQparm.endDate=null)}}},o=(0,a(1001).Z)(r,(function(){var e=this,t=e._self._c;return t("div",[t("a-input-group",{attrs:{compact:""},on:{click:function(t){return e.fnInit()}}},[null==e.obj||null==e.obj.name||0==e.obj.name.length?t("a-input",{style:"width:calc(100% - 32px )",attrs:{placeholder:"选择线索"}}):e._e(),null!=e.obj&&null!=e.obj.name&&e.obj.name.length>0?t("a-select",{style:"width:calc(100% - 32px )",attrs:{value:(e.obj||{}).name||null,placeholder:"选择线索",options:[],open:!1,disabled:e.disabled,allowClear:!0},on:{change:e.fnChange},scopedSlots:e._u([{key:"suffixIcon",fn:function(){},proxy:!0}],null,!1,2806561781)}):e._e(),t("a-button",{staticStyle:{width:"32px"},attrs:{type:"primary",ghost:"",disabled:e.disabled,icon:"search"}})],1),t("a-modal",{attrs:{visible:e.visible,title:"选择线索",width:"1000px",bodyStyle:{padding:"10px"}},on:{cancel:function(t){e.visible=!1},ok:e.fnOk}},[t("a-form",{staticClass:"inline-form",staticStyle:{"margin-bottom":"5px",display:"flex","justify-content":"end"},attrs:{layout:"inline"}},[t("a-form-item",{staticStyle:{width:"350px",overflow:"hidden"},attrs:{label:"经营单位"}},[t("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":"",treeData:e.$DEPTS&&e.$DEPTS[0].children,replaceFields:{title:"name",value:"id",key:"id"},placeholder:"选择经营单位",searchPlaceholder:"请输入关键字过滤","allow-clear":"",treeNodeFilterProp:"title"},model:{value:e.dQparm.assigndeptid,callback:function(t){e.$set(e.dQparm,"assigndeptid",t)},expression:"dQparm.assigndeptid"}})],1),t("a-form-item",{attrs:{label:"时间"}},[t("a-range-picker",{staticStyle:{width:"300px"},attrs:{"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm",placeholder:["开始时间","结束时间"],allowClear:""},on:{change:e.fnRangeChange}})],1),t("a-form-item",{staticStyle:{width:"300px"},attrs:{label:"关键字搜索"}},[t("a-input-search",{attrs:{placeholder:"请输入搜索关键字",allowClear:""},on:{search:function(t){return e.fnQuery()}},model:{value:e.dQparm.name,callback:function(t){e.$set(e.dQparm,"name",t)},expression:"dQparm.name"}})],1),t("a-form-item",{staticStyle:{"margin-right":"5px"}},[t("a-space",[t("a-button",{staticClass:"cant-btn-default",attrs:{type:"primary",loading:e.dTb.load,disabled:e.disabled},on:{click:function(t){return e.fnQuery()}}},[e._v("搜索")])],1)],1)],1),t("a-table",{attrs:{columns:this.dTb.colunms.filter((e=>!e.hide)),rowKey:e=>e.fid,dataSource:e.dTb.rows,pagination:e.dTb.pagination,size:"small",bordered:!0,loading:e.dTb.load},on:{change:e.fnQuery},scopedSlots:e._u([{key:"ix",fn:function(a,i,s){return t("span",{},[e._v(e._s((e.dTb.pagination.current-1)*e.dTb.pagination.pageSize+s+1)+" ")])}},{key:"ck",fn:function(a,i){return[t("a-radio",{attrs:{checked:i.fid==(e.dObj||{}).fid,disabled:e.disabled},on:{click:function(t){e.dObj=i}}})]}},{key:"caseCategoryID",fn:function(t,a,i){return[e._v(e._s(e._f("DICT")(t,"d_caseCategory")))]}},{key:"assignDate",fn:function(t,a,i){return[e._v(e._s(e._f("DATE")(t,"YYYY-MM-DD HH:mm")))]}}])})],1)],1)}),[],!1,null,null,null).exports},2670:function(e,t,a){a.d(t,{AS:function(){return d},en:function(){return l},v6:function(){return n}});var i=a(55743),s=a.n(i);const l={data(){return{dQparm:{},dTb:{rows:[],colunms:[],rows_chks:[],load:!1,pagination:{current:1,total:0,pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`共${e}条数据 当前从${t[0]}~${t[1]}条`},size:"defalut"}}},mounted(){this.dTb.colunms=this.schema.ListCols,this.fnTb_Query()},methods:{async fnTb_Query(e,t,a){this.dTb.pagination.current=e&&e.current||1,this.dTb.pagination.pageSize=e&&e.pageSize||10,this.dQparm.pageIndex=this.dTb.pagination.current,this.dQparm.pageSize=this.dTb.pagination.pageSize,this.dTb.load=!0;let i=await this.$api2(this.schema.Url.GetCount,this.dQparm);if(i.isOk){let e=parseInt(i.data);if(e>0){this.dTb.pagination.total=e;let t=await this.$api2(this.schema.Url.GetList,this.dQparm);t.isOk?this.dTb.rows=this.schema.ListFilter&&await this.schema.ListFilter(t.data)||t.data:this.$message.error(t&&t.message||this.schema.Desc+"数据列表查询失败")}else this.dTb.rows=[]}else this.$message.error(i&&i.message||this.schema.Desc+"数据分页统计失败");this.dTb.load=!1},async fnTb_Del(e){if(!e||e.length<=0)return this.$message.error("请选择要删除的"+this.schema.Desc+"数据");let t=this;this.$confirm({title:"操作确认",content:"确认删除当前选中的"+e.length+"条记录",onOk(){t.$api2(t.schema.Url.Delete,e).then((e=>{e&&e.isOk?(t.$message.success(t.schema.Desc+"数据已成功删除"),t.fnTb_Query()):t.$message.error(e&&e.message||"数据删除失败")}))}})}},filters:{time(e,t="YYYY-MM-DD HH:mm:ss"){let a=s()(e);return a.isValid()?a.format(t):null}}},n={data(){return{dObj:{show:!1,load:!1,mod:null,title:""}}},mounted(){this.dObj.title=this.schema&&this.schema.Desc||""},methods:{async Init(e,t="fid"){if(!(e&&e>0))return;this.dObj.mod=null,this.dObj.show=!0,this.dObj.load=!0;let a="fid"==t?{fid:e}:{id:e},i=await this.$api2(this.schema.Url.Get,null,a);this.dObj.load=!1,i&&i.isOk&&null!=i.data?this.dObj.mod=this.schema.DetailFilter&&await this.schema.DetailFilter(i.data)||i.data:this.$message.error(i&&i.message||this.schema.Desc+"可预览信息查询失败")}}},d={data(){return{dObj:{show:!1,load:!1,mod:null,title:"",rules:null}}},mounted(){this.dObj.title=this.schema.Desc||"",this.dObj.rules=this.schema.EditRules||null},methods:{async Init(e,t="fid"){if(parseInt(e)>=0){if(this.dObj.mod=null,this.dObj.show=!0,0==e)this.dObj.mod=this.schema.EditFilter&&await this.schema.EditFilter(null);else{this.dObj.load=!0;let a="fid"==t?{fid:e}:{id:e},i=await this.$api2(this.schema.Url.Get,null,a);i&&i.isOk&&null!=i.data?this.dObj.mod=this.schema.EditFilter&&await this.schema.EditFilter(i.data)||i.data:this.$message.error(i&&i.message||this.schema.Desc+"可编辑信息查询失败"),this.dObj.load=!1}this.$refs.editref&&this.$refs.editref.resetFields&&this.$refs.editref.resetFields()}},async Save(){this.$refs.editref.validate((async e=>{if(!e)return this.$message.error("输入数据校验失败，请重新输入"),!1;{this.dObj.load=!0;let e=this.schema.SaveFilter&&this.schema.SaveFilter(this.dObj.mod)||this.dObj.mod,t=await this.$api2(this.schema.Url.Save,e);this.dObj.load=!1,t&&t.isOk?parseInt(t.data)>0?(this.$message.success(this.schema.Desc+"数据保存成功"),this.schema.SaveFilterEnd&&(this.dObj.mod.fid=t.data,this.schema.SaveFilterEnd(this.dObj.mod)),this.dObj.show=!1,this.$emit("emOk",!0)):this.$message.error("数据保存失败"):this.$message.error(t&&t.message||this.schema.Desc+"数据保存失败")}}))},async Cancel(){this.dObj.show=!1,this.dObj.mod=null}}}},57492:function(e,t,a){var i=a(48368),s=a(11159),l=a(55743),n=a.n(l);let d={Desc:"样品",Table:"t_sample",TableType:"Clue"};d.Url={Save:`/api/${d.TableType}/Save_${d.Table}`,GetCount:`/api/${d.TableType}/GetCount_${d.Table}`,GetList:`/api/${d.TableType}/GetList_${d.Table}`,Get:`/api/${d.TableType}/Get_${d.Table}`,Delete:`/api/${d.TableType}/Delete_${d.Table}`},d.ListCols=[{title:"行政区划",dataIndex:"divisionID",show:!0,scopedSlots:{customRender:"divisionID"}},{title:"督办类别",dataIndex:"caseCategoryID",show:!1,scopedSlots:{customRender:"caseCategoryID"}},{title:"线索编号",dataIndex:"clueCode",show:!0,width:125},{title:"样品编号",dataIndex:"sampleCode",show:!0},{title:"样品名称",dataIndex:"name",show:!0},{title:"送检时间",dataIndex:"deliverDate",show:!0,scopedSlots:{customRender:"deliverDate"},width:100},{title:"线索ID",dataIndex:"clueID",show:!1,scopedSlots:{customRender:"clueID"}},{title:"创建时间",dataIndex:"createDate",show:!1,scopedSlots:{customRender:"createDate"}},{title:"快检时间",dataIndex:"quickCheckDate",show:!0,scopedSlots:{customRender:"quickCheckDate"},width:100},{title:"快检结果",dataIndex:"quickCheckResultID",show:!0,scopedSlots:{customRender:"quickCheckResultID"},width:100},{title:"司法鉴定时间",dataIndex:"identifyDate",show:!0,scopedSlots:{customRender:"identifyDate"}},{title:"司法鉴定结果",dataIndex:"identifyResultID",show:!0,scopedSlots:{customRender:"identifyResultID"}},{title:"操作",dataIndex:"op",show:!0,scopedSlots:{customRender:"op"},fixed:"right",width:300,className:"text-tc"}],d.ListFilter=e=>e,d.DetailFilter=async e=>{e.Clue={};let t=await(0,i.Z)(s.Z.Url.Get,null,{fid:e.clueID});t.isOk&&t.data&&(e.Clue=t.data),e._Attachment_In=[],e._Attachment_Ck=[];let a=await(0,i.Z)("/api/Common/GetAttachmentList",{TableName:"t_sample",TableID:e.fid,pageIndex:0,pageSize:100});return a&&a.isOk&&(e._Attachment_In=a.data.filter((e=>"In"==e.type)).map((e=>({name:e.name,url:e.relativePath}))),e._Attachment_Ck=a.data.filter((e=>"Ck"==e.type)).map((e=>({name:e.name,url:e.relativePath})))),Object.assign({},e)},d.EditRules={name:[{required:!0,message:"请输入样品名称",trigger:"blur"}],Clue:[{required:!0,trigger:"change",type:"object",validator:async(e,t)=>null!=t&&parseInt(t.fid)>0?Promise.resolve():Promise.reject("请选择线索")}],sampleCode:[{required:!0,message:"请输入样品编码",trigger:"blur"},{required:!0,trigger:"change",type:"string",validator:async(e,t)=>null!=t&&t.length>0?Promise.resolve():Promise.reject("请输入样品编码查询")}]},d.EditFilter=async e=>{let t=Object.assign({},e),a={fid:0,Clue:{},deliverDate:null,_Attachment_In:[],_Attachment_Ck:[],sampleCode:void 0,quickCheckDetails:{items:[]}};if(null!=e){null==t.caseCategoryID&&(t.caseCategoryID=void 0),null==t.clueGradeID&&(t.clueGradeID=void 0),null==t.sampleCode&&(t.sampleCode=void 0),null==t.quickCheckDate&&(t.quickCheckDate=n()().toString()),null==t.deliverDate&&(t.deliverDate=n()().toString()),t.Clue={};let e=await(0,i.Z)(s.Z.Url.Get,null,{fid:t.clueID});e.isOk&&e.data&&(t.Clue=e.data),t._Attachment_In=[],t._Attachment_Ck=[];let a=await(0,i.Z)("/api/Common/GetAttachmentList",{TableName:"t_sample",TableID:t.fid,pageIndex:0,pageSize:100});a&&a.isOk&&(t._Attachment_In=a.data.filter((e=>"In"==e.type)).map((e=>({name:e.name,url:e.relativePath}))),t._Attachment_Ck=a.data.filter((e=>"Ck"==e.type)).map((e=>({name:e.name,url:e.relativePath})))),null!=t.quickCheckDetails&&null!=t.quickCheckDetails.items||(t.quickCheckDetails={items:[]})}return Object.assign({},a,t)},d.SaveFilter=e=>{let t=Object.assign({},e);return delete t.Clue,delete t._Attachment_In,delete t._Attachment_Ck,t.quickCheckDate=n()(t.quickCheckDate).isValid()?n()(t.quickCheckDate).toJSON():null,t.identifyDate=n()(t.identifyDate).isValid()?n()(t.identifyDate).toJSON():null,t.deliverDate=n()(t.deliverDate).isValid()?n()(t.deliverDate).toJSON():null,t.createDate=n()(t.createDate).isValid()?n()(t.createDate).toJSON():null,t.modifyDate=n()(t.modifyDate).isValid()?n()(t.modifyDate).toJSON():null,null!=t.quickCheckDetails&&null!=t.quickCheckDetails.items&&0!=t.quickCheckDetails.items.length||delete t.quickCheckDetails,t},d.SaveFilterEnd=async e=>{await(0,i.Z)("/api/Common/SaveAttachments",[{tableName:"t_sample",type:"In",tableID:e.fid,relativePaths:e._Attachment_In.map((e=>e.url))},{tableName:"t_sample",type:"Ck",tableID:e.fid,relativePaths:e._Attachment_Ck.map((e=>e.url))}])},t.Z=d},11159:function(e,t,a){var i=a(55743),s=a.n(i),l=a(48368),n=a(26839),d=a(51223);let r={Desc:"线索",Table:"t_clue",TableType:"Clue"};r.Url={Save:`/api/${r.TableType}/Save_${r.Table}`,GetCount:`/api/${r.TableType}/GetCount_${r.Table}`,GetList:`/api/${r.TableType}/GetList_${r.Table}`,Get:`/api/${r.TableType}/Get_${r.Table}`,Delete:`/api/${r.TableType}/Delete_${r.Table}`},r.ListCols=[{title:"行政区划",dataIndex:"divisionID",show:!0,scopedSlots:{customRender:"divisionID"}},{title:"线索编号",dataIndex:"clueCode",show:!0},{title:"督办类别",dataIndex:"caseCategoryID",show:!0,scopedSlots:{customRender:"caseCategoryID"}},{title:"线索等级",dataIndex:"clueGradeID",show:!0,scopedSlots:{customRender:"clueGradeID"}},{title:"线索来源",dataIndex:"clueSourceID",show:!0,scopedSlots:{customRender:"clueSourceID"}},{title:"产品名称",dataIndex:"name",show:!0},{title:"宣传内容",dataIndex:"content",show:!1},{title:"车牌号",dataIndex:"plateNumber",show:!1},{title:"反馈时间",dataIndex:"respondDate",show:!1,scopedSlots:{customRender:"respondDate"}},{title:"反馈期限",dataIndex:"respondDueDate",show:!1,scopedSlots:{customRender:"respondDueDate"}},{title:"网页链接",dataIndex:"websiteUrl",show:!1},{title:"修改时间",dataIndex:"modifyDate",show:!1,scopedSlots:{customRender:"modifyDate"}},{title:"区县自侦",dataIndex:"isCreatedByCounty",show:!1},{title:"初研结果",dataIndex:"filterResultID",show:!0,scopedSlots:{customRender:"filterResultID"}},{title:"生成时间",dataIndex:"createDate",show:!1,scopedSlots:{customRender:"createDate"}},{title:"线索状态",dataIndex:"clueStateID",show:!0,scopedSlots:{customRender:"clueStateID"}},{title:"线索类别",dataIndex:"clueCategoryID",show:!0,scopedSlots:{customRender:"clueCategoryID"}},{title:"来自于大数据平台",dataIndex:"autoGenerated",show:!1},{title:"下发单位",dataIndex:"assignDeptID",show:!1,scopedSlots:{customRender:"assignDeptID"}},{title:"下发时间",dataIndex:"assignDate",show:!0,scopedSlots:{customRender:"assignDate"}},{title:"操作",dataIndex:"op",show:!0,scopedSlots:{customRender:"op"},fixed:"right",width:380,className:"text-tc"}],r.ListFilter=async e=>{let t=await(0,n.pr)(),a=[...e];return a.map((e=>{e.isCreatedByCounty=null==e.isCreatedByCounty?null:Boolean(e.isCreatedByCounty)?"是":"否",e.autoGenerated=null==e.autoGenerated?null:Boolean(e.autoGenerated)?"是":"否",e.assignDeptID=(0,d.cf)(t,"id",e.assignDeptID,"name")})),a},r.DetailFilter=async e=>{e.isCreatedByCounty=null==e.isCreatedByCounty?null:Boolean(e.isCreatedByCounty)?"是":"否",e.autoGenerated=null==e.autoGenerated?null:Boolean(e.autoGenerated)?"是":"否",e._Attachment_Img=[],e._Attachment_File=[];let t=await(0,l.Z)("/api/Common/GetAttachmentList",{TableName:"t_clue",TableID:e.fid,pageIndex:0,pageSize:100});return t&&t.isOk&&(e._Attachment_Img=t.data.filter((e=>"Img"==e.type)).map((e=>({name:e.name,url:e.relativePath}))),e._Attachment_File=t.data.filter((e=>"File"==e.type)).map((e=>({name:e.name,url:e.relativePath})))),Object.assign({},e)},r.EditRules={name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],divisionID:[{required:!0,trigger:"change",type:"object",validator:async(e,t)=>parseInt(t)>0?Promise.resolve():Promise.reject("请选择行政区划")}]},r.EditFilter=async e=>{let t={fid:0,contactInfoList:{items:[]},customFieldList:{items:[]},debitCardNumberList:{items:[]},expressNumberList:{items:[]},createDate:s()().toString()};if(null!=e){null==e.divisionID&&(e.divisionID=void 0),null==e.filterResultID&&(e.filterResultID=void 0),null==e.caseCategoryID&&(e.caseCategoryID=void 0),null==e.clueCategoryID&&(e.clueCategoryID=void 0),null==e.clueGradeID&&(e.clueGradeID=void 0),null==e.clueSourceID&&(e.clueSourceID=void 0),null==e.clueStateID&&(e.clueStateID=void 0),null==e.contactInfoList?e.contactInfoList={items:[]}:e.contactInfoList.items=e.contactInfoList.items.filter((e=>(e.name+e.phone+e.wechat+e.qq+e.plateNumber).length>0)),null==e.customFieldList?e.customFieldList={items:[]}:e.customFieldList.items=e.customFieldList.items.filter((e=>(e.fieldName+e.fieldValue).length>0)),null==e.debitCardNumberList?e.debitCardNumberList={items:[]}:e.debitCardNumberList.items=e.debitCardNumberList.items.filter((e=>(e.fieldName+e.fieldValue).length>0)),null==e.expressNumberList?e.expressNumberList={items:[]}:e.expressNumberList.items=e.expressNumberList.items.filter((e=>(e.fieldName+e.fieldValue).length>0)),e._Attachment_Img=[],e._Attachment_File=[];let t=await(0,l.Z)("/api/Common/GetAttachmentList",{TableName:"t_clue",TableID:e.fid,pageIndex:0,pageSize:100});t&&t.isOk&&(e._Attachment_Img=t.data.filter((e=>"Img"==e.type)).map((e=>({name:e.name,url:e.relativePath}))),e._Attachment_File=t.data.filter((e=>"File"==e.type)).map((e=>({name:e.name,url:e.relativePath}))))}return Object.assign(t,e)},r.SaveFilter=e=>{let t=Object.assign({},e);return delete t._Attachment_Img,delete t._Attachment_File,t.isCreatedByCounty=null,t.modifyDate=s()().toJSON(),null!=t.assignDate&&(t.assignDate=s()(t.assignDate).toJSON()),null!=t.respondDate&&(t.respondDate=s()(t.respondDate).toJSON()),null!=t.respondDueDate&&(t.respondDueDate=s()(t.respondDueDate).toJSON()),t},r.SaveFilterEnd=async e=>{await(0,l.Z)("/api/Common/SaveAttachments",[{tableName:"t_clue",type:"Img",tableID:e.fid,relativePaths:e._Attachment_Img.map((e=>e.url))},{tableName:"t_clue",type:"File",tableID:e.fid,relativePaths:e._Attachment_File.map((e=>e.url))}])},t.Z=r}}]);